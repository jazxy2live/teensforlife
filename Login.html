<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - TeensForLife</title>
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <header class="navbar">
        <div class="logo">
            <h1>TeensForLife</h1>
        </div>
        <div class="toggle">
            <i class="fas fa-bars"></i>
        </div>
        <nav class="nav-links">
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="resources.html">Resources</a></li>
                <li><a href="Login.html" class="login-btn">Login</a></li>
            </ul>
        </nav>
    </header>

    


    <div class="container">
        <form class="login-form" id="loginForm">
            <h1>Login to Your Account</h1>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your username" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
            </div>
            <button type="submit" class="login-btn">Login</button>
            <p class="register-link">Don't have an account? <a href="#">Register here</a></p>
            <button type="button" id="googleLoginBtn" class="login-btn">Login with Google</button>
        </form>
    </div>

  <div class="container">
    <div id="dashboard">
        <div class="user-info">
            <div class="avatar">J</div>
            <div>
                <div class="user-name" id="userName">Jazzy Indonesia</div>
                <p id="userEmail">indonesia.jazzy9@gmail.com</p>
            </div>
        </div>
        <p class="thank-you-message">
            Thank you for joining TeensForLife! You've contributed to revolutionizing the world.
        </p>
        <button class="button" id="homeBtn">Go to Home Page</button>
        <button class="button" id="logoutBtn">Logout</button>
    </div>
</div>

    
  <script>
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyAyYJOpFEKOueJ82rYpH3ViysP9dT93fyg",
        authDomain: "teensforlife-66155.firebaseapp.com",
        projectId: "teensforlife-66155",
        storageBucket: "teensforlife-66155.appspot.com",
        messagingSenderId: "572079189052",
        appId: "1:572079189052:web:d8502932dec58833a1a739",
        measurementId: "G-NEKSRBQZ4D"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Google login handler
    const googleLogin = () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider)
            .then((result) => {
                const user = result.user;
                console.log("User Info:", user);
                // Store user data in Firestore
                db.collection("users").doc(user.uid).set({
                    name: user.displayName,
                    email: user.email,
                    photoURL: user.photoURL,
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                }, { merge: true })
                .then(() => {
                    console.log("User saved to Firestore");
                    showDashboard(user); // Show dashboard with user info
                });
            })
            .catch((error) => {
                console.error("Error during sign-in:", error);
            });
    };

    // Logout handler
    const logout = () => {
        auth.signOut().then(() => {
            console.log("User signed out.");
            hideDashboard(); // Hide dashboard on logout
        });
    };

    // Show dashboard and populate user data
    const showDashboard = (user) => {
        document.getElementById('loginForm').style.display = 'none'; // Hide login form
        document.getElementById('dashboard').style.display = 'block'; // Show dashboard
        
        // Populate user data
        document.getElementById('userName').innerText = user.displayName;
        document.getElementById('userEmail').innerText = user.email;

        const userPic = document.getElementById('userPic');
        userPic.src = user.photoURL || 'https://via.placeholder.com/80?text=' + user.displayName.charAt(0).toUpperCase();
        userPic.onerror = function() {
            this.onerror = null; // Prevents infinite loop if placeholder fails
            this.src = 'https://via.placeholder.com/80?text=' + user.displayName.charAt(0).toUpperCase();
        };
    };

    // Hide dashboard and reset login form
    const hideDashboard = () => {
        document.getElementById('loginForm').style.display = 'block'; // Show login form
        document.getElementById('dashboard').style.display = 'none'; // Hide dashboard
    };

    // Event listeners
    document.getElementById('googleLoginBtn').addEventListener('click', googleLogin);
    document.getElementById('logoutBtn').addEventListener('click', logout);
    document.getElementById('homeBtn').addEventListener('click', () => {
        window.location.href = 'index.html'; // Navigate to home page
    });

    // Check if user is already logged in
    auth.onAuthStateChanged((user) => {
        if (user) {
            showDashboard(user); // Show dashboard if user is logged in
        } else {
            hideDashboard(); // Hide dashboard if no user is logged in
        }
    });

    // Toggle navbar for mobile
    const toggle = document.querySelector('.toggle');
    const navLinks = document.querySelector('.nav-links');
    toggle.addEventListener('click', () => {
        navLinks.classList.toggle('active');
        toggle.classList.toggle('rotated');
    });
</script>


    


</body>
</html>
